<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>SQLHelper | SQLHelper API Reference </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="SQLHelper | SQLHelper API Reference ">
      
      
      <link rel="icon" href="favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      <meta name="docfx:docurl" content="https://github.com/JaCraig/SQLHelper/blob/master/docfx_project/index.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="images/icon.png" alt="SQLHelper.DB">
            SQLHelper.DB
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="sqlhelper">SQLHelper</h1>

<p><a href="https://ci.appveyor.com/project/JaCraig/sqlhelper"><img src="https://ci.appveyor.com/api/projects/status/h687ovca9m893ww1?svg=true" alt="Build status"></a></p>
<p>SQLHelper is a simple class to help with running queries against a database.</p>
<h2 id="basic-usage">Basic Usage</h2>
<p>In order to use the system, you do need register it with your ServiceCollection:</p>
<pre><code>serviceCollection.AddCanisterModules();
				
</code></pre>
<p>This is required prior to using the SQLHelper class for the first time. Once Canister is set up, you can use the SQLHelper class:</p>
<pre><code>var Configuration = new ConfigurationBuilder()
            .AddInMemoryCollection()
            .Build();
var Instance = new SQLHelper(Configuration, SqlClientFactory.Instance, &quot;ConnectionString&quot;);
</code></pre>
<p>Or simply ask for an instance using dependency injection:</p>
<pre><code>public MyClass(SQLHelper helper) { ... }
</code></pre>
<p>The SQLHelper class takes in a IConfiguration class, a DbProviderFactory class, and the connection string. The connection string can just be the name of a connection string in your configuration object. Once an instance is set up, you can create a batch, add queries, and then execute them.</p>
<pre><code>var Results = Instance.CreateBatch()
            		   .AddQuery(CommandType.Text,&quot;SELECT * FROM [TestDatabase].[dbo].[TestTable]&quot;)
            		   .AddQuery(CommandType.Text,&quot;SELECT * FROM [TestDatabase].[dbo].[TestTable2]&quot;)
            		   .AddQuery(CommandType.Text,&quot;SELECT * FROM [TestDatabase].[dbo].[TestTable3]&quot;)
            		   .Execute();
					   
</code></pre>
<p>The Results object then holds the results for all 3 queries and is returned as IList&lt;IList<dynamic>&gt;. So in order to get the results from the queries:</dynamic></p>
<pre><code>var FirstQueryResults = Results[0];
var SecondQueryResults = Results[1];
var ThirdQueryResults = Results[2];
</code></pre>
<p>It is also possible to convert the results from the dynamic type to a class type that you specify:</p>
<pre><code>var TestTableClasses = FirstQueryResults.Select(x =&gt; (TestTableClass)x).ToList();
</code></pre>
<p>The type will be converted automatically for you with no special type conversion required.  SQLHelper also has an ExecuteScalar function:</p>
<pre><code>var Result = Instance.ExecuteScalar&lt;int&gt;();
</code></pre>
<p>This will either return the first value of the first set of results OR it will return the number of rows that were effected depending on whether or not the query was a select or not.</p>
<h2 id="installation">Installation</h2>
<p>The library is available via Nuget with the package name &quot;SQLHelper.DB&quot;. To install it run the following command in the Package Manager Console:</p>
<p>Install-Package SQLHelper.DB</p>
<h2 id="build-process">Build Process</h2>
<p>In order to build the library you will require the following as a minimum:</p>
<ol>
<li>Visual Studio 2022</li>
</ol>
<p>Other than that, just clone the project and you should be able to load the solution and build without too much effort.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/JaCraig/SQLHelper/blob/master/docfx_project/index.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <strong><a href='https://github.com/JaCraig/SQLHelper'>Open in Github</a></strong>
        </div>
      </div>
    </footer>
  </body>
</html>
